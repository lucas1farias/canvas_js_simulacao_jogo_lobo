

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title></title>
</head>
<body>
  <script>

    // #L
    function enemySetup({contentBox, amount}) {
      // O primeiro inimigo nasce numa posição específica (first é true)
      contentBox.push(new Foe({first: true}))

      // Do inimigo 2 adiante, estes pegam a posição do inimigo 1 e aumentam p/ algo entre 20 a 700 p/ ->
      for (let i = 1; i < amount; i++) {
        contentBox.push(new Foe({first: false, x: contentBox[i - 1].x + integersBetween(20, 700)}))
      }
    }

    function canvasInsert({content, contentBox}) {
      if (content === 'enemy') {
        contentBox.forEach(enemy => {
          // #G
          enemy.draw()
          // #J
          enemy.frameAdmin()
        })
      }
    }

    function init() {
      // #M: Os inimigos criados são chamados nesta função, p/ uso único (não deve ser usado na função "animate")
      enemySetup({contentBox: enemies, amount: 50})
    }

    class Foe {
      constructor({first, x}) {
        // #A: Atrib. criado p/ que o inimigo 1 tenha posição fixa, e os próximos usem ele como referência (se "true")
        this.first = first

        // #B: Todos os inimigos que estarão no canvas
        let koopaBlue = new Image()
        let koopaColorful = new Image()
        let koopaCyan = new Image()
        let koopaGolden = new Image()
        let koopaOrange = new Image()
        let koopaRed = new Image()
        let koopaViolet = new Image()
        let koopaWhiteYellow = new Image()

        // #C: Todos os arquivos de imagem dos inimigos
        koopaBlue.src = './assets/shells/shell_blue_tr.gif'
        koopaColorful.src = './assets/shells/shell_colorful_tr.gif'
        koopaCyan.src = './assets/shells/shell_cyan_tr.gif'
        koopaGolden.src = './assets/shells/shell_golden_tr.gif'
        koopaOrange.src = './assets/shells/shell_orange_tr.gif'
        koopaRed.src = './assets/shells/shell_red_tr.gif'
        koopaViolet.src = './assets/shells/shell_violet_tr.gif'
        koopaWhiteYellow.src = './assets/shells/shell_white_yellow_tr.gif'

        // #D: Os inimigos são colocados num array, p/ serem criados aleatoriamente em "enemySetup"
        this.enemies = [
          koopaBlue, koopaColorful, koopaCyan, koopaGolden, koopaOrange, koopaRed, koopaViolet, koopaWhiteYellow
        ]

        // #E: Todos os atributos na ordem exata para criar um inimigo em "draw" (todos têm "w" e "h" iguais)
        this.image = this.enemies[integersBetween(0, this.enemies.length - 1)]
        this.widthList = [0, 17.5, 34.5, 51.5]
        this.frameCounter = 0
        this.fixedHeight = 0
        this.widthList2 = [16, 17.5, 17, 17]
        this.srcHeight = 16
        // #A: O primeiro inimigo têm uma posição fixa. Os outros pegam a posição da 1 como referência em "enemySetup"
        if(this.first) {
          this.x = integersBetween(700, 1000)
        } else {
          this.x = x
        }
        this.y = 535
        this.width = 32
        this.height = 32
        this.modularCounter = 0
        this.modular = 10
        this.frameAmount = 3
      }

      // #F: Desenho do inimigo no canvas
      draw() {
        ctx.drawImage(
          this.image,
          this.widthList[this.frameCounter],
          this.fixedHeight,
          this.widthList2[this.frameCounter],
          this.srcHeight,
          this.x,
          this.y,
          this.width,
          this.height
        )
      }

      // #I: Transição de sprites de cada inimigo
      frameAdmin() {
        this.modularCounter++

        if (this.modularCounter % this.modular === 0) {
          if (this.frameCounter < this.frameAmount) {
            this.frameCounter++
          } else {
            this.frameCounter = 0
          }
        }
      }
    }

    // #K: Array que guardará os inimigos
    let enemies = []

  </script>
</body>
</html>